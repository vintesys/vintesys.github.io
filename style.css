* {
  box-sizing: border-box
}

body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
  background: #f4f5fb;
  color: #0f172a
}

.topbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background: #fff;
  border-bottom: 1px solid #e5e7eb
}

.brand {
  display: flex;
  align-items: center;
  gap: 10px
}

.pill {
  width: 44px;
  height: 32px;
  border-radius: 999px;
  background: #45c6dd;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 800
}

.title {
  font-weight: 800
}

.subtitle {
  font-size: 12px;
  color: #64748b
}

.actions {
  display: flex;
  gap: 8px
}

.actions button {
  border: 0;
  border-radius: 10px;
  padding: 8px 10px;
  background: #45c6dd;
  color: #fff;
  cursor: pointer;
  font-weight: 700
}

.actions button:nth-child(2) {
  background: #0ea5e9
}

.actions button:nth-child(3) {
  background: #e5e7eb;
  color: #111827
}

.layout {
  display: grid;
  grid-template-columns: 1.5fr 1.3fr;
  gap: 12px;
  padding: 12px
}

.panel {
  background: #fff;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(15, 23, 42, .06);
  overflow: hidden
}

#blocklyDiv {
  height: calc(100vh - 84px);
  min-height: 520px
}

.side {
  padding: 10px
}

.side h3 {
  margin: 6px 0;
  font-size: 12px;
  letter-spacing: .06em;
  color: #111827
}

.hint {
  margin: 8px 0 10px;
  font-size: 12px;
  color: #64748b
}

.stage {
  position: relative;
  width: 100%;
  padding-top: 60%;
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid #cbd5e1;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat
}

.scene-base {
  background-image: url('imagens/cenario_base.png');
  background-color: #e0f2fe
}

.scene-sala {
  background-image: url('imagens/cenario_sala.png');
  background-color: #fff7ed
}

.scene-cidade {
  background-image: url('imagens/cenario_cidade.png');
  background-color: #dbeafe
}

#ametechWrapper {
  position: absolute;
  width: 18%;
  aspect-ratio: 1/1.2;
  transform-origin: center bottom
}

#ametechSprite {
  width: 100%;
  height: 100%;
  background-repeat: no-repeat;
  background-position: center bottom;
  background-size: contain;
  background-image: url('imagens/ametech_robo.png')
}

/* ====== CAMINHADA (SPRITE SHEET 1024x256; 4 frames 256x256) ======
   O truque definitivo:
   - background-size: 400% 100%  (folha = 4x a largura do elemento)
   - animar background-position de 0% -> 100% com steps(4)
   Isso garante troca frame a frame (0, 33.33, 66.66, 100) e funciona em todos navegadores.
*/
#ametechSprite.walking {
  background-size: 400% 100%;
  background-position: 0% 140%;
  animation: ametechWalkFrames .72s steps(3) infinite;
  will-change: background-position;
}

#ametechSprite.walking.dir-right {
  background-image: url('imagens/ametech_robo_walk_right_fixed.png')
}

#ametechSprite.walking.dir-left {
  background-image: url('imagens/ametech_robo_walk_left_fixed.png')
}

#ametechSprite.walking.dir-back {
  background-image: url('imagens/ametech_robo_walking_back.png')
}

@keyframes ametechWalkFrames {
  from {
    background-position: 0% 100%
  }

  to {
    background-position: 100% 100%
  }
}


/* ====== PULO (SPRITE SHEET 4 FRAMES) ======
   - Corpo: animação no wrapper (sobe e desce) com translateY
   - Sprite: troca imagem e anima frames uma vez
*/
#ametechWrapper.jumping {
  /* valores configuráveis via JS */
  --jump-ms: 520ms;
  --jump-height: 28%;
  animation: ametechJumpBody var(--jump-ms) ease-out 1;
  will-change: transform;
}

@keyframes ametechJumpBody {
  0%   { transform: translateY(0); }
  40%  { transform: translateY(calc(-1 * var(--jump-height))); }
  60%  { transform: translateY(calc(-1 * var(--jump-height))); }
  100% { transform: translateY(0); }
}

#ametechSprite.jumping {
  background-image: url('imagens/ametech_robo_jump.png');
  background-repeat: no-repeat;
  background-size: 400% 100%;
  background-position: 0% 100%;
  /* sincroniza com o corpo */
  animation: ametechJumpFrames var(--jump-ms, 520ms) steps(3) 1;
  will-change: background-position;
}

@keyframes ametechJumpFrames {
  from { background-position: 0% 100%; }
  to   { background-position: 100% 100%; }
}











/* ====== GIRO (SPRITE SHEET 4 FRAMES) ======
   - Apenas troca frames do sprite (sem mover o corpo)
   - Usado pelos blocos: girar para esquerda / direita
*/
#ametechSprite.spinning {
  background-repeat: no-repeat;
  background-size: 400% 100%;
  background-position: 0% 100%;
  animation: ametechSpinFrames var(--spin-ms, 520ms) steps(3) 1;
  will-change: background-position;
}

#ametechSprite.spinning.spin-right {
  background-image: url('imagens/ametech_robo_spin_right.png');
}

#ametechSprite.spinning.spin-left {
  background-image: url('imagens/ametech_robo_spin_left.png');
}

@keyframes ametechSpinFrames {
  from { background-position: 0% 100%; }
  to   { background-position: 100% 100%; }
}


#speechBubble {
  position: absolute;
  left: 50%;
  bottom: 100%;
  transform: translate(-50%, -8px);
  max-width: 180px;
  padding: 8px 10px;
  border-radius: 12px;
  background: #0f172a;
  color: #fff;
  font-size: 12px;
  line-height: 1.25;
  border: 1px solid #111827;
  box-shadow: 0 6px 14px rgba(15, 23, 42, .35);
  text-align: center;
  transition: .15s
}

#speechBubble::after {
  content: "";
  position: absolute;
  left: 50%;
  bottom: -6px;
  width: 12px;
  height: 12px;
  background: #0f172a;
  border-right: 1px solid #111827;
  border-bottom: 1px solid #111827;
  transform: translateX(-50%) rotate(45deg)
}

#speechBubble.empty {
  opacity: 0;
  transform: translate(-50%, 6px)
}

#output {
  margin: 0;
  white-space: pre-wrap;
  word-break: break-word;
  background: #020617;
  color: #e5e7eb;
  border-radius: 10px;
  border: 1px solid #111827;
  padding: 10px;
  max-height: 240px;
  overflow: auto;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size: 11px
}

@media (max-width:980px) {
  .layout {
    grid-template-columns: 1fr;
  }

  /* Blockly usa a altura da tela sem engessar */
  #blocklyDiv {
    height: 55vh;
    min-height: 420px;
  }

  /* Cenário fica mais “horizontal” e útil */
  .stage {
    padding-top: 56%;
  }

  /* Saída maior no mobile para não ficar espremida */
  #output {
    max-height: 320px;
  }
}